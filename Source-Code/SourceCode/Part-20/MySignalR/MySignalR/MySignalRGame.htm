<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
 <style type="text/css">
     .gradientBoxesWithOuterShadows { 
        height: 101px;
        width: 301px; 
        padding: 20px;
        background-color:white; 

        /* outer shadows  (note the rgba is red, green, blue, alpha) */
        -webkit-box-shadow: 0px 0px 12px rgba(0, 0, 0, 0.4); 
        -moz-box-shadow: 0px 1px 6px rgba(23, 69, 88, .5);

        /* rounded corners */
        -webkit-border-radius: 12px;
        -moz-border-radius: 7px; 
        border-radius: 7px;

        /* gradients */
        background: -webkit-gradient(linear, left top, left bottom, 
        color-stop(0%, white), color-stop(15%, white), color-stop(100%, #D7E9F5)); 
        background: -moz-linear-gradient(top, white 0%, white 55%, #D5E4F3 130%); 
}
        .canvas {
            background-color:blue;
            border-radius: 20px;
        }     
        
        #main {width: 100%;height: 100%;}
        #right {
           
           left:501px;
                       
        }
        .name {
        }
        .count {
            padding:0 0 0 8px;
        } 


    </style>
</head>
<body>
 <div class="container">
        <input type="hidden" id="displayname" />
         <div id="main">
            <div id="left" class="gradientBoxesWithOuterShadows">
                <canvas id="myCanvas" width="20" height="20" class="canvas"></canvas>
            </div>
            <div id="right">
                <ol id="usersList">                    
                    
                </ol>                
            </div>
        </div>
        
    </div>

    <!--Reference the jQuery library. -->
    <script src="Scripts/jquery-1.6.4.min.js" ></script>
    <!--Reference the SignalR library. -->
    <script src="Scripts/jquery.signalR-1.0.0.js" type="text/javascript"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script type="text/javascript" src="/signalr/hubs"></script>
    <!--Add script to update the page and send messages.--> 

    <script type="text/javascript">
        function GetQueryStringParams(sParam) {
            var sPageURL = window.location.search.substring(1);
            var sURLVariables = sPageURL.split('&');
            for (var i = 0; i < sURLVariables.length; i++) {
                var sParameterName = sURLVariables[i].split('=');
                if (sParameterName[0] == sParam) {
                    return sParameterName[1];
                }
            }
        }
        function Update(name) {
            if ($('#usersList li span.name:contains(' + name + ')').length)
                $('#' + name).text(parseInt($('#' + name).text()) + 1);
            else
                $('#usersList').append('<li><span class="name">' + name + '</span> : <span id="' + name + '" class="count">1</span></li>');
        }
        function SetPosition(x, y) {
            var o = { left: x, top: y };
            $("#myCanvas").show(100).offset(o);
        }
        $(function () {
            // Declare a proxy to reference the hub. 
            var chat = $.connection.myGameHub;
            // Create a function that the hub can call to broadcast messages.
            chat.client.addMessage = function (Top, Left, name) {
                $("#myCanvas").animate({
                    opacity: '1'
                });
                SetPosition(Top, Left);
                Update(name);
            };


            // Get the user name and store it to prepend to messages
            $('#displayname').val(GetQueryStringParams("n"));

            // Start the connection.
            $.connection.hub.start().done(function () {
                $('#myCanvas').click(function () {

                    $("#myCanvas").animate({
                        opacity: '0'
                    });
                    // Call the Send method on the hub.

                    chat.server.send($('#displayname').val());
                    //                    chat.server.points(); 
                    // Clear text box and reset focus for next comment. 

                });
            });
        });
    </script>

</body>
</html>
